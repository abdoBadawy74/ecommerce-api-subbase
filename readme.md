# üõí Ecommerce API Documentation

**Base URL:** `https://ndmfkgcmkiforsnevdqw.supabase.co`  
**Auth Version:** Supabase Auth v1  
**Database:** Supabase PostgREST

---

## üîê Authentication

### ‚ñ∂Ô∏è Sign Up  
**POST** `/auth/v1/signup`  

Registers a new user.

**Body:**
```json
{
  "email": "user@example.com",
  "password": "12345678"
}
```

**Response (201):**
```json
{
  "user": {
    "id": "uuid",
    "email": "user@example.com",
    "role": "authenticated"
  },
  "session": {
    "access_token": "string",
    "refresh_token": "string"
  }
}
```

---

### ‚ñ∂Ô∏è Sign In  
**POST** `/auth/v1/token?grant_type=password`  

**Body:**
```json
{
  "email": "user@example.com",
  "password": "12345678"
}
```

**Response (200):**
```json
{
  "access_token": "string",
  "token_type": "bearer",
  "expires_in": 3600,
  "user": {
    "id": "uuid",
    "email": "user@example.com"
  }
}
```

---

## üë§ Profiles

### ‚ñ∂Ô∏è Get Current User Profile  
**GET** `/rest/v1/profiles?id=eq.{USER_ID}`  

**Headers:**
```
apikey: <ANON_KEY>
Authorization: Bearer <USER_ACCESS_TOKEN>
```

**Response (200):**
```json
[
  {
    "id": "uuid",
    "email": "user@example.com",
    "role": "user",
    "created_at": "2025-10-19T12:00:00Z"
  }
]
```

---

### ‚ñ∂Ô∏è Update Profile (User Only)  
**PATCH** `/rest/v1/profiles?id=eq.{USER_ID}`  

**Body:**
```json
{
  "full_name": "Ahmed Ali"
}
```

**Response (200):**
```json
{
  "id": "uuid",
  "email": "user@example.com",
  "role": "user",
  "full_name": "Ahmed Ali"
}
```

---

## üõçÔ∏è Products

### ‚ñ∂Ô∏è Get All Products (Public)  
**GET** `/rest/v1/products`  

**Response (200):**
```json
[
  {
    "id": 1,
    "name": "T-Shirt",
    "price": 250,
    "description": "Cotton T-shirt",
    "image_url": "https://...",
    "created_at": "2025-10-19T12:00:00Z"
  }
]
```

---

### ‚ñ∂Ô∏è Get Single Product  
**GET** `/rest/v1/products?id=eq.{PRODUCT_ID}`

**Response (200):**
```json
[
  {
    "id": 1,
    "name": "T-Shirt",
    "price": 250,
    "description": "Cotton T-shirt",
    "image_url": "https://..."
  }
]
```

---

## ‚öôÔ∏è Admin Endpoints

> üß† Requires user role = "admin"

### ‚ñ∂Ô∏è Add Product  
**POST** `/rest/v1/products`

**Headers:**
```
apikey: <SERVICE_ROLE_KEY>
Authorization: Bearer <ADMIN_ACCESS_TOKEN>
Content-Type: application/json
```

**Body:**
```json
{
  "name": "New Product",
  "price": 500,
  "description": "High-quality item",
  "image_url": "https://..."
}
```

**Response (201):**
```json
{
  "id": 12,
  "name": "New Product",
  "price": 500,
  "description": "High-quality item",
  "image_url": "https://..."
}
```

---

### ‚ñ∂Ô∏è Update Product  
**PATCH** `/rest/v1/products?id=eq.{PRODUCT_ID}`  

**Body:**
```json
{
  "price": 600
}
```

**Response (200):**
```json
{
  "id": 12,
  "name": "New Product",
  "price": 600
}
```

---

### ‚ñ∂Ô∏è Delete Product  
**DELETE** `/rest/v1/products?id=eq.{PRODUCT_ID}`  

**Response (204):**
```json
null
```

---

### ‚ñ∂Ô∏è Get All Users (Admin)  
**GET** `/rest/v1/profiles`  

**Headers:**
```
apikey: <SERVICE_ROLE_KEY>
Authorization: Bearer <ADMIN_ACCESS_TOKEN>
```

**Response (200):**
```json
[
  {
    "id": "uuid",
    "email": "admin@shop.com",
    "role": "admin"
  },
  {
    "id": "uuid",
    "email": "user@shop.com",
    "role": "user"
  }
]
```

---

## ‚öõÔ∏è Using in React (Supabase Client)

```js
import { createClient } from "@supabase/supabase-js";

const supabase = createClient(
  "https://ndmfkgcmkiforsnevdqw.supabase.co",
  process.env.REACT_APP_SUPABASE_KEY
);

// Example: Fetch products
const { data: products } = await supabase.from("products").select("*");

// Example: Add new product (admin only)
const { data, error } = await supabase
  .from("products")
  .insert([
    { name: "Laptop", price: 1000, description: "Gaming Laptop" }
  ]);
```

---

## üß† Notes
- All requests must include proper `apikey` and `Authorization` headers.
- Admins should use `service_role` key in backend or secure environment only.
- RLS policies ensure only admins can modify or delete products.
- Regular users can view products and edit only their own profile.

---

**Author:** Generated by ChatGPT  
**Version:** 2.0.0  
**Date:** 2025-10-19
